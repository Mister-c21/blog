<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoreSpace | Wiki Ultimate</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #8a2be2; /* blueviolet */
            --primary-light: #a052f5;     
            --background-color: #0f0a17; 
            --sidebar-bg: rgba(26, 21, 36, 0.98); 
            --text-color: #f8f8ff; /* ghost */
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --blur-value: 15px;                  
            --font-stack: 'Poppins', sans-serif;
            --menu-width: 280px; 
            --list-width-desktop: 400px; 
            --text-color-muted: #aaa;
        }

        @keyframes slideIn { from { transform: translateY(100%); } to { transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes spin { to { transform: rotate(360deg); } }
        @keyframes wave-anim { 0%, 100% { height: 30px; opacity: 0.5; } 50% { height: 80px; opacity: 1; } }

        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        body, html { height: 100%; margin: 0; padding: 0; overflow: hidden; background-color: var(--background-color); color: var(--text-color); font-family: var(--font-stack); display: flex; }

        /* --- SIDEBAR --- */
        .sidebar { 
            position: fixed; top: 0; left: 0; height: 100%; width: var(--menu-width); 
            background-color: var(--sidebar-bg); backdrop-filter: blur(var(--blur-value));
            z-index: 5000; transform: translateX(-100%); transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-right: 1px solid var(--glass-border); box-shadow: 20px 0 50px rgba(0,0,0,0.5);
        }
        .menu-open .sidebar { transform: translateX(0); }
        .sidebar-header { padding: 30px 25px; font-weight: 800; font-size: 1.6rem; color: var(--primary-light); border-bottom: 1px solid var(--glass-border); display: flex; justify-content: space-between; align-items: center; }
        .close-sidebar { background: none; border: none; color: var(--text-color); font-size: 1.3rem; cursor: pointer; }
        .sidebar-nav a { display: flex; align-items: center; padding: 20px 25px; color: var(--text-color); text-decoration: none; font-weight: 500; transition: 0.3s; }
        .sidebar-nav a:hover { background: rgba(138, 43, 226, 0.15); color: var(--primary-light); }

        /* --- LISTA PRINCIPAL --- */
        .direct-container { 
            width: 100%; width: var(--list-width-desktop); height: 100vh; 
            display: flex; flex-direction: column; background: var(--glass-bg); 
            backdrop-filter: blur(var(--blur-value)); border-right: 1px solid var(--glass-border); 
            z-index: 10; flex-shrink: 0; transition: 0.3s;
        }
        @media (min-width: 768px) { .menu-open .direct-container { transform: translateX(30px); opacity: 0.6; } }

        .direct-header { padding: 25px 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--glass-border); }
        .search-bar { padding: 15px 20px; }
        .search-input-wrapper { position: relative; display: flex; align-items: center; width: 100%; }
        .search-bar input { width: 100%; padding: 14px 85px 14px 18px; border-radius: 16px; border: 1px solid var(--glass-border); background: rgba(255,255,255,0.06); color: white; }
        .search-icons { position: absolute; right: 18px; display: flex; gap: 15px; color: var(--primary-light); }
        
        .filter-tabs { padding: 10px 15px; display: flex; gap: 10px; overflow-x: auto; scrollbar-width: none; border-bottom: 1px solid var(--glass-border); }
        .filter-tabs button { background: rgba(255,255,255,0.05); border: 1px solid var(--glass-border); color: white; padding: 8px 18px; border-radius: 20px; cursor: pointer; white-space: nowrap; }
        .filter-tabs button.active { background: var(--primary-color); }

        .contact-list { flex-grow: 1; overflow-y: auto; }
        .contact-item { display: flex; align-items: center; padding: 18px 20px; cursor: pointer; border-bottom: 1px solid rgba(255,255,255,0.03); }
        .avatar { width: 55px; height: 55px; border-radius: 50%; margin-right: 18px; object-fit: cover; background: #222; border: 1px solid var(--glass-border); }

        /* --- UX MOBILE: MODAL PERFIL --- */
        .profile-panel { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.8); backdrop-filter: blur(10px); 
            display: none; z-index: 4000; 
        }
        .profile-open .profile-panel { display: block; }
        .profile-modal-content { 
            width: 100%; height: 100%; background: #0c0814; position: relative; 
            display: flex; flex-direction: column; animation: slideIn 0.4s cubic-bezier(0,0,0.2,1); 
        }

        /* --- UX DESKTOP: PAINEL FIXO --- */
        @media (min-width: 768px) {
            .direct-container { width: var(--list-width-desktop); }
            .profile-panel { position: relative; display: block; flex-grow: 1; background: #0c0814; }
            .profile-modal-content { animation: none; border-left: 1px solid var(--glass-border); }
            .btn-close-profile { display: none; }
        }

        .profile-header-bg { height: 260px; background: linear-gradient(to bottom, var(--primary-color), #0c0814); position: relative; flex-shrink: 0; }
        .profile-avatar-big { width: 160px; height: 160px; border-radius: 50%; border: 6px solid #0c0814; position: absolute; bottom: -80px; left: 50%; transform: translateX(-50%); object-fit: cover; }
        .profile-body { flex-grow: 1; overflow-y: auto; padding: 100px 40px 40px; }
        .read-more-btn { background: var(--primary-color); color: white; border: none; padding: 16px; border-radius: 12px; cursor: pointer; margin-top: 30px; font-weight: 700; width: 100%; }

        /* --- MODAIS --- */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(10, 8, 15, 0.98); z-index: 6000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(12px); padding: 20px; }
        .modal-overlay.active { display: flex; }
        .modal-card { background: #161122; width: 100%; max-width: 750px; max-height: 85vh; border-radius: 25px; padding: 40px; border: 1px solid var(--glass-border); overflow-y: auto; position: relative; }
        .voice-waves { display: flex; gap: 12px; height: 100px; align-items: center; justify-content: center; }
        .wave { width: 8px; height: 30px; background: var(--primary-light); border-radius: 10px; animation: wave-anim 1s infinite; }
        .loader { width: 40px; height: 40px; border: 4px solid rgba(255,255,255,0.1); border-top-color: var(--primary-color); border-radius: 50%; animation: spin 1s infinite linear; margin: 30px auto; }
        .wiki-article-card { background: rgba(255,255,255,0.03); padding: 15px; border-radius: 12px; margin-bottom: 10px; border-left: 4px solid var(--primary-color); }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="sidebar-header">
            <span>LoreSpace</span>
            <button class="close-sidebar" onclick="document.body.classList.remove('menu-open')"><i class="fas fa-times"></i></button>
        </div>
        <nav class="sidebar-nav">
            <a href="../Home.html"><i class="fas fa-home" style="margin-right:15px"></i> Início</a>
        </nav>
    </div>

    <div class="modal-overlay" id="voice-modal">
        <div style="text-align: center; width: 100%;">
            <h2 style="color:var(--primary-light)">Estou ouvindo...</h2>
            <div id="v-transcript" style="font-size: 2rem; margin: 30px; color: white; min-height: 4rem; font-weight: 600;"></div>
            <div class="voice-waves"><div class="wave"></div><div class="wave" style="animation-delay:0.2s"></div><div class="wave" style="animation-delay:0.4s"></div></div>
            <button onclick="closeVoiceSearch()" style="margin-top:40px; background:none; border:1px solid white; color:white; padding:12px 40px; border-radius:30px; cursor:pointer;">Cancelar</button>
        </div>
    </div>

    <div class="modal-overlay" id="reading-modal">
        <div class="modal-card">
            <button onclick="closeReadingModal()" style="position:absolute; top:20px; right:20px; background:var(--primary-color); border:none; color:white; width:40px; height:40px; border-radius:50%; cursor:pointer;">×</button>
            <h2 id="rtitle" style="color:var(--primary-light); margin-bottom:20px;"></h2>
            
            <div style="background: rgba(138,43,226,0.1); padding: 15px; border-radius: 15px; margin-bottom: 25px; display: flex; align-items: center; gap: 20px; border: 1px solid var(--glass-border);">
                <button id="audio-btn" onclick="toggleAudio()" style="background: var(--primary-color); border:none; color:white; width:50px; height:50px; border-radius:50%; cursor:pointer;"><i class="fas fa-play"></i></button>
                <div>
                    <strong style="display:block">Sintetizador de Voz</strong>
                    <small style="opacity:0.6">Clique para ouvir a biografia</small>
                </div>
            </div>

            <div id="rtext" style="line-height:2; color:#eee; text-align: justify; white-space: pre-line; font-size: 1.1rem;"></div>
        </div>
    </div>

    <div class="direct-container">
        <div class="direct-header">
            <i class="fas fa-bars" onclick="document.body.classList.toggle('menu-open')" style="cursor:pointer; color: var(--primary-light); font-size: 1.2rem;"></i>
            <h2 style="font-size: 1rem; letter-spacing: 2px;">CHARACTERS</h2>
            <span></span>
        </div>
        <div class="search-bar">
            <div class="search-input-wrapper">
                <input type="text" id="search-input" placeholder="Buscar na Wikipedia...">
                <div class="search-icons">
                    <button onclick="startVoiceSearch()" style="background:none; border:none; color:inherit; cursor:pointer;"><i class="fas fa-microphone"></i></button>
                    <i class="fas fa-search"></i>
                </div>
            </div>
        </div>
        <div class="filter-tabs">
            <button class="active" data-filter="all">All</button>
            <button data-filter="animes">Animes</button>
            <button data-filter="games">Games</button>
            <button data-filter="books">Books</button>
        </div>
        <div class="contact-list" id="contact-list">
            <div class="contact-item" data-category="animes" data-char="Goku">
                <img src="" class="avatar" data-wiki="Goku">
                <div><h3>Goku</h3><span style="font-size:0.8rem; opacity:0.6">Dragon Ball</span></div>
            </div>
            <div class="contact-item" data-category="books" data-char="Hermione Granger">
                <img src="" class="avatar" data-wiki="Hermione Granger">
                <div><h3>Hermione</h3><span style="font-size:0.8rem; opacity:0.6">Harry Potter</span></div>
            </div>
            <div class="contact-item" data-category="games" data-char="Link (The Legend of Zelda)">
                <img src="" class="avatar" data-wiki="Link">
                <div><h3>Link</h3><span style="font-size:0.8rem; opacity:0.6">Zelda</span></div>
            </div>
            <div class="contact-item" data-category="games" data-char="Kratos">
                <img src="" class="avatar" data-wiki="Kratos (God of War)">
                <div><h3>Kratos</h3><span style="font-size:0.8rem; opacity:0.6">God of War</span></div>
            </div>
        </div>
    </div>

    <div class="profile-panel">
        <div class="profile-modal-content">
            <button class="btn-close-profile" onclick="document.body.classList.remove('profile-open')" style="position:absolute; top:20px; right:20px; z-index:10; background:rgba(0,0,0,0.5); border:none; color:white; width:45px; height:45px; border-radius:50%; cursor:pointer;">×</button>
            <div class="profile-header-bg"><img id="p-avatar" src="" class="profile-avatar-big"></div>
            <div class="profile-body">
                <h1 id="p-name" style="text-align:center; font-size: 2.2rem; margin: 0;">LoreSpace</h1>
                <p id="p-category" style="text-align:center; color:var(--primary-light); font-weight:700; text-transform:uppercase; font-size:0.8rem; letter-spacing:2px;"></p>
                <div id="desc-container">
                    <p id="p-desc-short" style="text-align:justify; line-height:1.8; color:#ccc; margin-top:30px;"></p>
                    <button id="btn-read-more" class="read-more-btn" style="display:none;" onclick="openReadingModal()">ABRIR BIOGRAFIA COMPLETA</button>
                </div>
                <div style="margin-top:50px;">
                    <h3 style="border-bottom:1px solid var(--glass-border); padding-bottom:10px; font-size:0.9rem; color:var(--text-color-muted)">TÓPICOS RELACIONADOS</h3>
                    <div id="wiki-articles-list"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API = "https://pt.wikipedia.org/w/api.php?action=query&format=json&origin=*";
        let fullText = "", isSpeaking = false, synth = window.speechSynthesis;

        async function loadWiki(name) {
            const desc = document.getElementById('p-desc-short'), img = document.getElementById('p-avatar');
            const btnMore = document.getElementById('btn-read-more'), list = document.getElementById('wiki-articles-list');
            desc.innerHTML = '<div class="loader"></div>';
            list.innerHTML = ''; btnMore.style.display = 'none';

            try {
                const res = await fetch(`${API}&prop=extracts|pageimages&exintro&explaintext&pithumbsize=600&titles=${encodeURIComponent(name)}`);
                const data = await res.json();
                const page = Object.values(data.query.pages)[0];
                if (page.extract) {
                    fullText = page.extract;
                    document.getElementById('p-name').textContent = page.title;
                    img.src = page.thumbnail ? page.thumbnail.source : '';
                    desc.textContent = page.extract.substring(0, 300) + "...";
                    btnMore.style.display = 'block';
                }
                const sRes = await fetch(`${API}&prop=extracts&exintro&explaintext&generator=search&gsrsearch=${encodeURIComponent(name)}&gsrlimit=4`);
                const sData = await sRes.json();
                if (sData.query) {
                    Object.values(sData.query.pages).forEach(item => {
                        if (item.title === page.title) return;
                        const card = document.createElement('div');
                        card.className = 'wiki-article-card';
                        card.innerHTML = `<h4>${item.title}</h4><a href="https://pt.wikipedia.org/?curid=${item.pageid}" target="_blank" style="color:var(--primary-light); text-decoration:none; font-size:0.8rem; font-weight:700;">VER ARTIGO</a>`;
                        list.appendChild(card);
                    });
                }
            } catch(e) { desc.textContent = "Erro ao carregar."; }
        }

        function toggleAudio() {
            const btn = document.getElementById('audio-btn');
            if(isSpeaking) { synth.cancel(); isSpeaking = false; btn.innerHTML = '<i class="fas fa-play"></i>'; }
            else {
                const utter = new SpeechSynthesisUtterance(fullText);
                utter.onend = () => { isSpeaking = false; btn.innerHTML = '<i class="fas fa-play"></i>'; };
                synth.speak(utter); isSpeaking = true;
                btn.innerHTML = '<i class="fas fa-stop"></i>';
            }
        }

        function openReadingModal() {
            document.getElementById('rtitle').textContent = document.getElementById('p-name').textContent;
            document.getElementById('rtext').textContent = fullText;
            document.getElementById('reading-modal').classList.add('active');
        }
        function closeReadingModal() { synth.cancel(); isSpeaking = false; document.getElementById('reading-modal').classList.remove('active'); }

        const recog = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recog.lang = 'pt-BR'; recog.interimResults = true;
        function startVoiceSearch() { document.getElementById('voice-modal').classList.add('active'); recog.start(); }
        function closeVoiceSearch() { document.getElementById('voice-modal').classList.remove('active'); recog.stop(); }
        recog.onresult = (e) => {
            const t = Array.from(e.results).map(r => r[0].transcript).join('');
            document.getElementById('v-transcript').textContent = t;
            if(e.results[0].isFinal) { document.getElementById('search-input').value = t; applyFilter(); setTimeout(closeVoiceSearch, 800); }
        };

        function applyFilter() {
            const term = document.getElementById('search-input').value.toLowerCase();
            const tab = document.querySelector('.filter-tabs button.active').dataset.filter;
            document.querySelectorAll('.contact-item').forEach(item => {
                const match = item.dataset.char.toLowerCase().includes(term);
                const matchTab = tab === 'all' || item.dataset.category === tab;
                item.style.display = match && matchTab ? 'flex' : 'none';
            });
        }
        document.getElementById('search-input').addEventListener('input', applyFilter);
        document.querySelectorAll('.filter-tabs button').forEach(b => b.addEventListener('click', () => {
            document.querySelector('.filter-tabs button.active').classList.remove('active');
            b.classList.add('active'); applyFilter();
        }));

        document.querySelectorAll('.contact-item').forEach(item => {
            item.addEventListener('click', () => {
                document.getElementById('p-category').textContent = item.querySelector('span').textContent;
                document.body.classList.add('profile-open');
                loadWiki(item.dataset.char);
            });
        });

        (async () => {
            for (let img of document.querySelectorAll('.avatar')) {
                const res = await fetch(`${API}&prop=pageimages&pithumbsize=100&titles=${encodeURIComponent(img.dataset.wiki)}`);
                const data = await res.json();
                const page = Object.values(data.query.pages)[0];
                if (page.thumbnail) img.src = page.thumbnail.source;
            }
        })();
    </script>
</body>
</html>
